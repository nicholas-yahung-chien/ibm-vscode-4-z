# VSCode4z 開發環境詳細安裝與操作指南

VSCode4z 是一個專為 IBM Z 開發環境設計的整合式工具包，提供完整的 Visual Studio Code 開發環境，包含 IBM Z 相關擴充功能、Zowe CLI 工具鏈，以及 Python 和 Java 開發環境。

## 專案特色

* **一鍵安裝**：自動下載並配置所有必要的開發工具
* **IBM Z 整合**：內建 Zowe CLI、Z Open Editor 等 IBM Z 開發工具
* **多語言支援**：支援 COBOL、PL/I、Assembler、REXX 等 IBM Z 程式語言

## 前置準備

* 作業系統：Windows x64
* 已取得並解壓縮 `VSCode4z-x.y.z.zip` 壓縮檔
* 網路連線：用於下載工具和擴充功能

## 安裝步驟

### 步驟 1：安裝環境工具

* 在解壓縮後的資料夾內，執行 `install.exe`。
* 安裝過程將自動完成以下事項：

  * **Visual Studio Code** 工具解壓並設定
  * **IBM Semeru Java OpenJDK 21** 工具解壓並設定
  * **Python** 環境解壓並設定
  * **Node.js** 環境解壓並設定
  * **Zowe-CLI** 核心工具及插件安裝
  * **VSCode 擴充功能** 自動安裝（包含檔案鎖定處理機制）
  * 開發環境啟動期間的環境路徑及設定檔調整（包含 `PATH` 與 `JAVA_HOME` 等）
  * 建立 VSCode 的啟動捷徑（請務必透過此捷徑啟動）

在過程中，系統會多次提示按下 `Enter` 鍵以確認繼續，請依指示操作。

**注意**：安裝過程中會自動處理檔案鎖定問題，確保所有工具和擴充功能都能正確安裝。

### 步驟 2：設定工作區（workspace）參數

* 完成安裝後，執行 `workspace.exe`。

#### 基本參數設定

* 根據提示輸入以下基本必要資訊：

  * **IBM Z 伺服器位置（host）**
  * **帳號名稱（user）**
  * **密碼（password）**

#### 進階參數設定（選單操作）

設定選單將提供以下可選項目，需輸入選項編號進行設定：

| 選項編號 | 說明及預設值                               | 詳細輸入指引                 |
| ---- | ------------------------------------ | ---------------------- |
| 1    | 設定 zosmf 連線 port（預設 443）             | 輸入 `1` 後再輸入指定 port 號   |
| 2    | 設定 tso 連線編碼（預設 1047）                 | 輸入 `2` 後再輸入指定編碼值       |
| 3    | 設定 ssh 連線 port（預設 22）                | 輸入 `3` 後再輸入指定 port 號   |
| 4    | 設定 ftp 連線 port（預設 21）                | 輸入 `4` 後再輸入指定 port 號   |
| 5    | 設定 rse 連線 port 與編碼（預設 6800, IBM-937） | 輸入 `5` 後依序輸入 port 及編碼值 |
| 6    | 設定 zOpenDebug 連線 port（預設 8143）       | 輸入 `6` 後再輸入指定 port 號   |
| 7    | 結束設定，保存並套用參數                         | 輸入 `7` 結束設定程序          |

* 完成選單設定後，系統將更新並保存參數到 `workspace/zowe.config.json`。

### 步驟 3：使用 VSCode 環境

* 執行完 `install.exe` 後，系統將在資料夾中生成一個 `VSCode.lnk` 捷徑檔。
* 雙擊該捷徑檔即可開啟已設定完成的 VSCode 環境。
* 在 VSCode 中，可透過開啟資料夾功能查看預設提供的 `workspace` 目錄，進行範例專案的檢視並與遠端 IBM Z 主機連線。
* 在 VSCode 中，可啟動終端機功能，切換到 `workspace` 目錄下，以 `zowe` 指令與遠端主機連線。
* 輸入 `zowe --help` 以查看 zowe-cli 指令的操作方式。
* 初次啟動 VSCode 會維持英文使用者介面，只要關閉後再次啟動，之後就都會是中文語系介面。

## 卸載步驟

若要卸載環境，請執行：

* 執行 `uninstall.exe`。
* 腳本將清除展開的工具環境檔案，僅保留原始的 `.zip` 壓縮檔案。
* 若有備份的設定檔案，將自動回復至最後備份狀態。

## 版本更新記錄

### v2.6.0 (2025/01/13)
* 優化檔案鎖定檢測和進程終止功能，改善安裝和卸載流程
* 優化建置流程，改善配置載入和檔案管理
* 優化下載流程，改善配置載入和檔案管理
* 優化設定檔載入邏輯，改善配置管理
* 優化檔案操作流程，改善檔案鎖定處理
* 優化路徑處理邏輯，改善目錄結構處理
* 優化使用者介面，改善進度顯示和錯誤處理

### v2.5.0 (2025/01/15)
* 新增 VSCode 擴充功能安裝後的進程清理機制，避免檔案被鎖定
* 優化檔案鎖定檢測和進程終止功能，改善刪除流程
* 加強使用者介面，改善進度顯示和錯誤處理
* 優化檔案壓縮邏輯，改善檔案收集和排除模式處理

### v2.4.11 (2025/01/15)
* 優化 Zowe-Cli 安裝流程，改善 npm 命令執行
* 重構壓縮功能，使用 pyminizip 提升效能
* 重構下載流程，提升檔案管理效能
* 優化檔案清理邏輯，提升刪除效能

### v2.3.0 (2025/01/15)
* 重構檔案處理邏輯，提升壓縮和檔案管理效能
* 新增檔案排除功能，改善打包流程
* 重構設定流程，提升使用者體驗
* 新增備份功能，改善設定檔管理

### v2.2.1 (2025/01/15)
* 初始版本，提供完整的 VSCode4z 開發環境安裝功能
* 提供基本的建置和打包功能
* 提供基本的檔案下載功能
* 提供基本的卸載功能

## 注意事項

* 若安裝遇到問題，請確認是否需要系統管理員權限。
* 若需進行遠端主機連線，請先確認 VPN 連線、防火牆及網路環境是否開放所需的連線埠。
* 安裝過程中如遇到檔案鎖定問題，系統會自動處理，無需手動干預。
* 若遇問題，請聯絡開發負責人：[nicholas.yahung.chien@ibm.com](mailto:nicholas.yahung.chien@ibm.com)。

## 技術支援

* **GitHub Issues**：[https://github.com/nicholas-yahung-chien/ibm-vscode-4-z/issues](https://github.com/nicholas-yahung-chien/ibm-vscode-4-z/issues)
* **文件**：[https://github.com/nicholas-yahung-chien/ibm-vscode-4-z](https://github.com/nicholas-yahung-chien/ibm-vscode-4-z)

---

**IBM Taiwan Technology Expert Labs**
**版本:** 2.6.0
**日期:** 2025/07/13
